    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <script>
        // 全局变量
        let userToken = localStorage.getItem('sms_platform_token');
        let userData = JSON.parse(localStorage.getItem('sms_platform_user') || '{}');
        let baseUrl = localStorage.getItem('sms_api_server') || ''; // 默认为空，相对路径
        let isOfflineMode = localStorage.getItem('sms_offline_mode') === 'true'; // 离线模式标志
        
        // API列表定义
        const apiList = {
            user: [
                {
                    name: "获取个人资料",
                    endpoint: "/api/auth/profile",
                    method: "GET",
                    description: "获取当前登录用户的个人资料信息",
                    params: []
                },
                {
                    name: "修改密码",
                    endpoint: "/api/auth/change-password",
                    method: "GET",
                    description: "修改当前登录用户的密码",
                    params: [
                        { name: "old_password", label: "旧密码", type: "password", required: true },
                        { name: "new_password", label: "新密码", type: "password", required: true }
                    ]
                }
            ],
            project: [
                {
                    name: "获取项目列表",
                    endpoint: "/api/projects",
                    method: "GET",
                    description: "获取所有可用项目列表",
                    params: [
                        { name: "page", label: "页码", type: "number", value: 1 },
                        { name: "per_page", label: "每页数量", type: "number", value: 10 },
                        { name: "keyword", label: "搜索关键词", type: "text" }
                    ]
                },
                {
                    name: "搜索项目",
                    endpoint: "/api/projects/search",
                    method: "GET",
                    description: "根据关键词搜索项目",
                    params: [
                        { name: "keyword", label: "搜索关键词", type: "text", required: true }
                    ]
                },
                {
                    name: "收藏项目",
                    endpoint: "/api/projects/favorite/{project_id}",
                    method: "GET",
                    description: "将指定项目添加到收藏列表",
                    params: [
                        { name: "project_id", label: "项目ID", type: "number", required: true, isPathParam: true }
                    ]
                },
                {
                    name: "取消收藏项目",
                    endpoint: "/api/projects/favorite/{project_id}",
                    method: "GET",
                    description: "从收藏列表中删除指定项目",
                    params: [
                        { name: "project_id", label: "项目ID", type: "number", required: true, isPathParam: true },
                        { name: "action", label: "操作", type: "hidden", value: "delete", required: true }
                    ]
                },
                {
                    name: "获取收藏的项目列表",
                    endpoint: "/api/projects/favorites",
                    method: "GET",
                    description: "获取用户已收藏的所有项目",
                    params: [
                        { name: "page", label: "页码", type: "number", value: 1 },
                        { name: "per_page", label: "每页数量", type: "number", value: 10 }
                    ]
                },
                {
                    name: "获取专属对接的项目列表",
                    endpoint: "/api/projects/exclusive",
                    method: "GET",
                    description: "获取用户已加入专属对接的项目列表",
                    params: [
                        { name: "page", label: "页码", type: "number", value: 1 },
                        { name: "per_page", label: "每页数量", type: "number", value: 10 }
                    ]
                },
                {
                    name: "加入专属对接",
                    endpoint: "/api/projects/exclusive/{project_id}",
                    method: "GET",
                    description: "加入指定项目的专属对接",
                    params: [
                        { name: "project_id", label: "项目ID", type: "number", required: true, isPathParam: true }
                    ]
                },
                {
                    name: "获取所有可加入的专属项目",
                    endpoint: "/api/projects/all-exclusive",
                    method: "GET",
                    description: "获取所有可加入专属对接的项目列表",
                    params: [
                        { name: "page", label: "页码", type: "number", value: 1 },
                        { name: "per_page", label: "每页数量", type: "number", value: 10 }
                    ]
                }
            ],
            number: [
                {
                    name: "取号（获取手机号）",
                    endpoint: "/api/numbers/get",
                    method: "GET",
                    description: "随机获取一个可用的手机号码",
                    params: [
                        { name: "project_code", label: "项目代码", type: "text", required: true }
                    ]
                },
                {
                    name: "指定取号（获取指定手机号）",
                    endpoint: "/api/numbers/get-specific",
                    method: "GET",
                    description: "获取指定的手机号码",
                    params: [
                        { name: "project_code", label: "项目代码", type: "text", required: true },
                        { name: "number", label: "手机号码", type: "text", required: true }
                    ]
                },
                {
                    name: "获取短信验证码",
                    endpoint: "/api/numbers/sms/{request_id}",
                    method: "GET",
                    description: "获取指定请求ID对应的短信验证码",
                    params: [
                        { name: "request_id", label: "请求ID", type: "text", required: true, isPathParam: true }
                    ]
                },
                {
                    name: "释放号码",
                    endpoint: "/api/numbers/release/{request_id}",
                    method: "GET",
                    description: "释放指定请求ID对应的手机号码",
                    params: [
                        { name: "request_id", label: "请求ID", type: "text", required: true, isPathParam: true }
                    ]
                },
                {
                    name: "拉黑号码",
                    endpoint: "/api/numbers/blacklist",
                    method: "GET",
                    description: "将指定手机号码加入黑名单",
                    params: [
                        { name: "number", label: "手机号码", type: "text", required: true },
                        { name: "reason", label: "拉黑原因", type: "text" }
                    ]
                },
                {
                    name: "获取我的号码列表",
                    endpoint: "/api/numbers/my-numbers",
                    method: "GET",
                    description: "获取用户已获取的手机号码列表",
                    params: [
                        { name: "page", label: "页码", type: "number", value: 1 },
                        { name: "per_page", label: "每页数量", type: "number", value: 10 },
                        { name: "status", label: "状态过滤", type: "select", options: [
                            { value: "", label: "全部" },
                            { value: "available", label: "可用" },
                            { value: "used", label: "已使用" },
                            { value: "released", label: "已释放" },
                            { value: "blacklisted", label: "已拉黑" }
                        ]}
                    ]
                }
            ],
            account: [
                {
                    name: "查询余额",
                    endpoint: "/api/account/balance",
                    method: "GET",
                    description: "查询用户当前账户余额",
                    params: []
                },
                {
                    name: "获取交易记录",
                    endpoint: "/api/account/transactions",
                    method: "GET",
                    description: "获取用户的交易记录列表",
                    params: [
                        { name: "page", label: "页码", type: "number", value: 1 },
                        { name: "per_page", label: "每页数量", type: "number", value: 10 },
                        { name: "type", label: "交易类型", type: "select", options: [
                            { value: "", label: "全部" },
                            { value: "topup", label: "充值" },
                            { value: "consume", label: "消费" },
                            { value: "refund", label: "退款" }
                        ]}
                    ]
                },
                {
                    name: "账户充值",
                    endpoint: "/api/account/topup",
                    method: "GET",
                    description: "为用户账户充值",
                    params: [
                        { name: "amount", label: "充值金额", type: "number", required: true },
                        { name: "payment_method", label: "支付方式", type: "select", required: true, options: [
                            { value: "alipay", label: "支付宝" },
                            { value: "wechat", label: "微信支付" }
                        ]}
                    ]
                }
            ]
        };
        
        // 初始化函数
        $(document).ready(function() {
            console.log('初始化API测试界面...');
            
            try {
                // 添加服务器配置
                addServerConfig();
                
                // 检查认证状态
                checkAuth();
                
                // 绑定事件
                bindEvents();
                
                // 生成API表单
                generateApiForms();
                
                // 隐藏加载指示器
                hideLoading();
            } catch (e) {
                console.error('初始化错误:', e);
                alert('初始化界面出错: ' + e.message);
                hideLoading();
            }
        });
        
        // 添加服务器配置功能
        function addServerConfig() {
            // 创建服务器配置表单
            const serverConfigHtml = `
                <div class="card mb-4" id="serverConfig">
                    <div class="card-header ${isOfflineMode ? 'bg-danger' : 'bg-warning'}">
                        <i class="fas fa-server me-2"></i>API服务器配置
                    </div>
                    <div class="card-body">
                        <form id="serverConfigForm">
                            <div class="input-group mb-3">
                                <span class="input-group-text">服务器地址</span>
                                <input type="text" class="form-control" id="serverUrl" placeholder="例如：http://localhost:5000" value="${baseUrl}" ${isOfflineMode ? 'disabled' : ''}>
                                <button class="btn btn-outline-primary" type="submit" ${isOfflineMode ? 'disabled' : ''}>保存</button>
                            </div>
                            <div class="form-text mb-3">
                                如果API服务器与此页面不在同一域，请设置完整的API服务器地址。留空则使用相对路径。
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="offlineModeSwitch" ${isOfflineMode ? 'checked' : ''}>
                                <label class="form-check-label" for="offlineModeSwitch">
                                    离线测试模式 
                                    <span class="badge ${isOfflineMode ? 'bg-danger' : 'bg-secondary'}">
                                        ${isOfflineMode ? '已启用' : '已禁用'}
                                    </span>
                                </label>
                            </div>
                            <small class="text-muted">
                                启用离线模式后，所有API请求将使用模拟数据，不会发送到服务器。适用于前端界面测试。
                            </small>
                        </form>
                    </div>
                </div>
            `;
            
            // 插入到容器的顶部
            $('.container').prepend(serverConfigHtml);
            
            // 绑定表单提交事件
            $('#serverConfigForm').on('submit', function(e) {
                e.preventDefault();
                const newUrl = $('#serverUrl').val().trim();
                baseUrl = newUrl;
                localStorage.setItem('sms_api_server', newUrl);
                alert('服务器地址已设置为: ' + (newUrl || '相对路径'));
                console.log('设置服务器地址:', baseUrl);
            });
            
            // 绑定离线模式开关事件
            $('#offlineModeSwitch').on('change', function() {
                isOfflineMode = $(this).is(':checked');
                localStorage.setItem('sms_offline_mode', isOfflineMode);
                
                // 更新UI
                if (isOfflineMode) {
                    $('#serverUrl').attr('disabled', true);
                    $('#serverConfigForm button[type="submit"]').attr('disabled', true);
                    $('#serverConfig .card-header').removeClass('bg-warning').addClass('bg-danger');
                    $('#offlineModeSwitch').next().find('span').removeClass('bg-secondary').addClass('bg-danger').text('已启用');
                } else {
                    $('#serverUrl').attr('disabled', false);
                    $('#serverConfigForm button[type="submit"]').attr('disabled', false);
                    $('#serverConfig .card-header').removeClass('bg-danger').addClass('bg-warning');
                    $('#offlineModeSwitch').next().find('span').removeClass('bg-danger').addClass('bg-secondary').text('已禁用');
                }
                
                console.log('离线模式:', isOfflineMode ? '已启用' : '已禁用');
                
                // 如果切换到离线模式并且未登录，自动使用模拟登录
                if (isOfflineMode && !userToken) {
                    mockLogin();
                }
            });
            
            // 从本地存储加载之前保存的服务器地址
            const savedUrl = localStorage.getItem('sms_api_server');
            if (savedUrl) {
                baseUrl = savedUrl;
                $('#serverUrl').val(savedUrl);
                console.log('已从本地存储加载服务器地址:', baseUrl);
            }
        }
        
        // 检查认证状态
        function checkAuth() {
            if (userToken && Object.keys(userData).length > 0) {
                // 已登录状态
                showLoggedInState();
                
                // 更新页面上的用户信息
                updateUserInfo();
                
                // 检查令牌有效性
                checkTokenValidity();
            } else {
                // 未登录状态
                showLoggedOutState();
                
                // 如果是离线模式，自动使用模拟登录
                if (isOfflineMode) {
                    mockLogin();
                }
            }
        }
        
        // 显示已登录状态
        function showLoggedInState() {
            $('#authCard').addClass('d-none');
            $('#userInfoPanel').removeClass('d-none');
            $('#apiTestPanel').removeClass('d-none');
        }
        
        // 显示未登录状态
        function showLoggedOutState() {
            $('#authCard').removeClass('d-none');
            $('#userInfoPanel').addClass('d-none');
            $('#apiTestPanel').addClass('d-none');
            
            // 清空本地存储的登录信息（除非是离线模式）
            if (!isOfflineMode) {
                localStorage.removeItem('sms_platform_token');
                localStorage.removeItem('sms_platform_user');
                userToken = null;
                userData = {};
            }
        }
        
        // 更新用户信息
        function updateUserInfo() {
            $('#usernameInfo').text(userData.username || '-');
            $('#emailInfo').text(userData.email || '-');
            $('#balanceInfo').text(userData.balance || '0.00');
        }
        
        // 检查令牌有效性
        function checkTokenValidity() {
            // 如果没有令牌，则直接返回
            if (!userToken) {
                return;
            }
            
            // 离线模式不检查令牌有效性
            if (isOfflineMode) {
                return;
            }
            
            $.ajax({
                url: baseUrl + '/api/auth/profile',
                method: 'GET',
                data: { token: userToken },
                dataType: 'json',
                success: function(data) {
                    // 更新用户信息
                    if (data) {
                        userData = data;
                        localStorage.setItem('sms_platform_user', JSON.stringify(userData));
                        updateUserInfo();
                    }
                },
                error: function(error) {
                    // 如果令牌无效，退出登录
                    if (error.status === 401) {
                        showLoggedOutState();
                    }
                    console.log('验证令牌时出错:', error);
                },
                complete: function() {
                    // 始终隐藏加载指示器
                    hideLoading();
                }
            });
        }
        
        // 绑定事件处理程序
        function bindEvents() {
            // 登录表单提交
            $('#loginForm').on('submit', function(e) {
                e.preventDefault();
                login();
            });
            
            // 注册表单提交
            $('#registerForm').on('submit', function(e) {
                e.preventDefault();
                register();
            });
            
            // 清除凭证
            $('#clearToken').on('click', function(e) {
                e.preventDefault();
                logout();
            });
            
            // 复制结果
            $('#copyResult').on('click', function() {
                copyToClipboard('#resultContent');
            });
        }
        
        // 登录函数
        function login() {
            const username = $('#username').val();
            const password = $('#password').val();
            
            if (!username || !password) {
                alert('请填写用户名和密码');
                return;
            }
            
            callApi('/api/auth/login', { 
                username: username, 
                password: password 
            }, function(response) {
                if (response.token) {
                    userToken = response.token;
                    userData = response.user;
                    
                    // 保存到本地存储
                    localStorage.setItem('sms_platform_token', userToken);
                    localStorage.setItem('sms_platform_user', JSON.stringify(userData));
                    
                    // 显示已登录状态
                    showLoggedInState();
                    updateUserInfo();
                    
                    // 清空表单
                    $('#loginForm')[0].reset();
                    
                    showResult('登录成功', response);
                } else {
                    showResult('登录失败', response);
                }
            }, function(error) {
                handleApiError(error);
            });
        }
        
        // 注册函数
        function register() {
            const username = $('#regUsername').val();
            const email = $('#regEmail').val();
            const password = $('#regPassword').val();
            
            if (!username || !email || !password) {
                alert('请填写完整注册信息');
                return;
            }
            
            callApi('/api/auth/register', {
                username: username,
                email: email,
                password: password
            }, function(response) {
                if (response.token) {
                    userToken = response.token;
                    userData = response.user;
                    
                    // 保存到本地存储
                    localStorage.setItem('sms_platform_token', userToken);
                    localStorage.setItem('sms_platform_user', JSON.stringify(userData));
                    
                    // 显示已登录状态
                    showLoggedInState();
                    updateUserInfo();
                    
                    // 清空表单
                    $('#registerForm')[0].reset();
                    
                    showResult('注册成功', response);
                } else {
                    showResult('注册失败', response);
                }
            }, function(error) {
                handleApiError(error);
            });
        }
        
        // 登出函数
        function logout() {
            // 清除本地存储和内存中的令牌
            localStorage.removeItem('sms_platform_token');
            localStorage.removeItem('sms_platform_user');
            userToken = null;
            userData = {};
            
            // 显示未登录状态
            showLoggedOutState();
            
            // 如果是离线模式，自动使用模拟登录
            if (isOfflineMode) {
                mockLogin();
            }
        }
        
        // 生成API测试表单
        function generateApiForms() {
            // 用户管理API
            generateApiCategory('user-apis', '用户管理', apiList.user);
            
            // 项目管理API
            generateApiCategory('project-apis', '项目管理', apiList.project);
            
            // 号码管理API
            generateApiCategory('number-apis', '号码管理', apiList.number);
            
            // 账户管理API
            generateApiCategory('account-apis', '账户管理', apiList.account);
        }
        
        // 生成API分类
        function generateApiCategory(elementId, title, apis) {
            const $element = $(`#${elementId}`);
            
            // 设置标题
            $element.html(`
                <div class="card-header">
                    <i class="fas fa-code me-2"></i>${title}
                </div>
                <div class="card-body">
                    <div class="accordion" id="${elementId}-accordion">
                    </div>
                </div>
            `);
            
            // 添加每个API
            const $accordion = $(`#${elementId}-accordion`);
            
            apis.forEach((api, index) => {
                const apiId = `${elementId}-api-${index}`;
                const formId = `${apiId}-form`;
                
                const accordionItem = `
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" 
                                data-bs-target="#${apiId}-collapse" aria-expanded="false" aria-controls="${apiId}-collapse">
                                ${api.name}
                            </button>
                        </h2>
                        <div id="${apiId}-collapse" class="accordion-collapse collapse" data-bs-parent="#${elementId}-accordion">
                            <div class="accordion-body">
                                <p class="api-description">${api.description}</p>
                                <p><small class="text-muted">接口: ${api.endpoint}</small></p>
                                <form id="${formId}" class="api-form">
                                    <input type="hidden" name="endpoint" value="${api.endpoint}">
                                    <input type="hidden" name="method" value="${api.method}">
                                    
                                    <div class="row mb-3">
                                        ${generateFormFields(api.params)}
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane me-1"></i>发送请求
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                `;
                
                $accordion.append(accordionItem);
                
                // 绑定表单提交事件
                $(`#${formId}`).on('submit', function(e) {
                    e.preventDefault();
                    callApiFromForm(this);
                });
            });
        }
        
        // 生成表单字段
        function generateFormFields(params) {
            if (!params || params.length === 0) {
                return '<div class="col-12"><p class="text-muted">此接口无需额外参数</p></div>';
            }
            
            let html = '';
            
            params.forEach((param) => {
                if (param.isPathParam) {
                    // 路径参数使用隐藏字段记录，但显示为普通输入字段
                    html += `
                        <div class="col-md-6 mb-3">
                            <label class="form-label ${param.required ? 'required-field' : ''}">${param.label}</label>
                            <input type="${param.type}" class="form-control" name="${param.name}" 
                                data-is-path-param="true" ${param.required ? 'required' : ''}
                                ${param.value ? `value="${param.value}"` : ''}>
                        </div>
                    `;
                } else if (param.type === 'hidden') {
                    // 隐藏字段
                    html += `
                        <input type="hidden" name="${param.name}" value="${param.value || ''}">
                    `;
                } else if (param.type === 'select') {
                    // 下拉选择框
                    let options = '';
                    param.options.forEach(option => {
                        options += `<option value="${option.value}">${option.label}</option>`;
                    });
                    
                    html += `
                        <div class="col-md-6 mb-3">
                            <label class="form-label ${param.required ? 'required-field' : ''}">${param.label}</label>
                            <select class="form-select" name="${param.name}" ${param.required ? 'required' : ''}>
                                ${options}
                            </select>
                        </div>
                    `;
                } else {
                    // 普通输入字段
                    html += `
                        <div class="col-md-6 mb-3">
                            <label class="form-label ${param.required ? 'required-field' : ''}">${param.label}</label>
                            <input type="${param.type}" class="form-control" name="${param.name}" 
                                ${param.required ? 'required' : ''} ${param.value ? `value="${param.value}"` : ''}>
                        </div>
                    `;
                }
            });
            
            return html;
        }
        
        // 从表单调用API
        function callApiFromForm(form) {
            const $form = $(form);
            const formData = new FormData($form[0]);
            const endpoint = formData.get('endpoint');
            const method = formData.get('method');
            
            // 构建参数对象
            const params = {};
            const pathParams = {};
            
            // 收集表单字段
            $form.find('input, select, textarea').each(function() {
                const $field = $(this);
                const name = $field.attr('name');
                const value = $field.val();
                
                // 忽略endpoint和method字段
                if (name === 'endpoint' || name === 'method') {
                    return;
                }
                
                // 检查是否为路径参数
                if ($field.data('is-path-param')) {
                    pathParams[name] = value;
                } else if (value) { // 只添加有值的参数
                    params[name] = value;
                }
            });
            
            // 处理路径参数
            let finalEndpoint = endpoint;
            Object.keys(pathParams).forEach(param => {
                finalEndpoint = finalEndpoint.replace(`{${param}}`, pathParams[param]);
            });
            
            // 调用API
            callApi(finalEndpoint, params, function(data) {
                showResult('请求成功', data);
            }, function(error) {
                handleApiError(error);
            });
        }
        
        // 调用API的通用函数
        function callApi(endpoint, params, successCallback, errorCallback) {
            showLoading();
            
            // 添加token参数
            if (userToken) {
                params.token = userToken;
            }
            
            console.log('调用API:', endpoint, '参数:', params);
            
            // 如果是离线模式，使用模拟数据
            if (isOfflineMode) {
                setTimeout(function() {
                    hideLoading();
                    const mockResponse = getMockResponse(endpoint, params);
                    console.log('模拟响应:', mockResponse);
                    
                    if (mockResponse.error) {
                        if (errorCallback) {
                            errorCallback({
                                status: 400,
                                responseText: JSON.stringify(mockResponse)
                            });
                        }
                    } else {
                        if (successCallback) {
                            successCallback(mockResponse);
                        }
                    }
                }, 500); // 模拟网络延迟
                return;
            }
            
            $.ajax({
                url: baseUrl + endpoint,
                method: 'GET', // 所有API都支持GET
                data: params,
                dataType: 'json',
                timeout: 10000, // 10秒超时
                success: function(response) {
                    console.log('API响应成功:', response);
                    hideLoading();
                    if (successCallback) {
                        successCallback(response);
                    }
                },
                error: function(xhr, status, error) {
                    console.log('API请求失败:', status, error, xhr);
                    hideLoading();
                    
                    // 处理跨域错误
                    if (xhr.status === 0) {
                        alert('可能存在跨域问题，请确保API服务器已开启CORS支持，或者切换到离线测试模式');
                    }
                    
                    if (errorCallback) {
                        errorCallback(xhr);
                    }
                }
            });
        }
        
        // 处理API错误
        function handleApiError(xhr) {
            let errorMessage = '请求失败';
            let errorData = '';
            
            try {
                const response = JSON.parse(xhr.responseText);
                errorMessage = response.message || response.error || '未知错误';
                errorData = response;
            } catch (e) {
                errorMessage = xhr.statusText || '未知错误';
                errorData = { status: xhr.status, statusText: xhr.statusText };
            }
            
            showResult(`错误：${errorMessage}`, errorData);
        }
        
        // 显示结果
        function showResult(title, data) {
            // 设置模态框标题
            $('#resultModalLabel').text(title);
            
            // 设置结果内容
            $('#resultContent').text(JSON.stringify(data, null, 2));
            
            // 显示模态框
            const resultModal = new bootstrap.Modal(document.getElementById('resultModal'));
            resultModal.show();
        }
        
        // 复制到剪贴板
        function copyToClipboard(elementId) {
            const text = $(elementId).text();
            navigator.clipboard.writeText(text).then(function() {
                alert('复制成功');
            }, function() {
                alert('复制失败，请手动复制');
            });
        }
        
        // 显示加载指示器
        function showLoading() {
            $('#loading').fadeIn(100);
            // 5秒后自动隐藏加载指示器（以防卡住）
            setTimeout(function() {
                hideLoading();
            }, 5000);
        }
        
        // 隐藏加载指示器
        function hideLoading() {
            $('#loading').fadeOut(100);
        }
        
        // 模拟登录（离线模式使用）
        function mockLogin() {
            const mockUser = {
                id: 1,
                username: "测试用户",
                email: "test@example.com",
                balance: 100.0,
                is_admin: false,
                is_active: true,
                created_at: new Date().toISOString(),
                updated_at: new Date().toISOString()
            };
            
            const mockToken = "mock_token_" + Date.now();
            
            userToken = mockToken;
            userData = mockUser;
            
            // 保存到本地存储
            localStorage.setItem('sms_platform_token', userToken);
            localStorage.setItem('sms_platform_user', JSON.stringify(userData));
            
            // 显示已登录状态
            showLoggedInState();
            updateUserInfo();
            
            console.log('模拟登录成功:', userData);
        }
        
        // 获取模拟响应数据
        function getMockResponse(endpoint, params) {
            // 通用时间戳
            const now = new Date().toISOString();
            
            // 模拟ID生成器
            const generateId = () => Math.floor(Math.random() * 10000);
            
            // 模拟手机号生成器
            const generatePhone = () => {
                const prefixes = ['137', '138', '139', '186', '188', '199'];
                const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
                const suffix = Math.floor(Math.random() * 100000000).toString().padStart(8, '0');
                return prefix + suffix;
            };
            
            // 登录相关接口
            if (endpoint === '/api/auth/login') {
                return {
                    message: "登录成功",
                    token: "mock_token_" + Date.now(),
                    user: {
                        id: 1,
                        username: params.username || "测试用户",
                        email: "test@example.com",
                        balance: 100.0,
                        is_admin: false,
                        is_active: true,
                        created_at: now,
                        updated_at: now
                    }
                };
            }
            
            if (endpoint === '/api/auth/register') {
                return {
                    message: "注册成功",
                    token: "mock_token_" + Date.now(),
                    user: {
                        id: 1,
                        username: params.username || "新用户",
                        email: params.email || "test@example.com",
                        balance: 0.0,
                        is_admin: false,
                        is_active: true,
                        created_at: now,
                        updated_at: now
                    }
                };
            }
            
            if (endpoint === '/api/auth/profile') {
                return userData;
            }
            
            if (endpoint === '/api/auth/change-password') {
                return {
                    message: "密码修改成功"
                };
            }
            
            // 项目相关接口
            if (endpoint === '/api/projects' || endpoint === '/api/projects/search' || 
                endpoint === '/api/projects/favorites' || endpoint === '/api/projects/exclusive' || 
                endpoint === '/api/projects/all-exclusive') {
                
                return {
                    items: [
                        {
                            id: 1,
                            name: "微信登录",
                            code: "wechat_login",
                            description: "微信验证码登录",
                            price: 1.0,
                            success_rate: 0.98,
                            available: true,
                            is_exclusive: false,
                            created_at: now,
                            updated_at: now
                        },
                        {
                            id: 2,
                            name: "支付宝登录",
                            code: "alipay_login",
                            description: "支付宝验证码登录",
                            price: 1.2,
                            success_rate: 0.95,
                            available: true,
                            is_exclusive: false,
                            created_at: now,
                            updated_at: now
                        },
                        {
                            id: 3,
                            name: "抖音登录",
                            code: "douyin_login",
                            description: "抖音验证码登录",
                            price: 2.0,
                            success_rate: 0.90,
                            available: true,
                            is_exclusive: true,
                            created_at: now,
                            updated_at: now
                        }
                    ],
                    total: 3,
                    page: parseInt(params.page) || 1,
                    per_page: parseInt(params.per_page) || 10,
                    pages: 1
                };
            }
            
            if (endpoint.includes('/api/projects/favorite/')) {
                if (params.action === 'delete') {
                    return {
                        message: "取消收藏成功"
                    };
                } else {
                    return {
                        message: "项目收藏成功"
                    };
                }
            }
            
            if (endpoint.includes('/api/projects/exclusive/')) {
                return {
                    message: "加入专属对接成功"
                };
            }
            
            // 号码相关接口
            if (endpoint === '/api/numbers/get' || endpoint === '/api/numbers/get-specific') {
                const phoneNumber = params.number || generatePhone();
                const requestId = "req_" + Date.now();
                
                return {
                    message: "获取号码成功",
                    phone_number: {
                        id: generateId(),
                        number: phoneNumber,
                        status: "available",
                        project_id: 1,
                        project_name: "微信登录",
                        user_id: 1,
                        sms_code: null,
                        request_id: requestId,
                        created_at: now,
                        updated_at: now,
                        released_at: null
                    }
                };
            }
            
            if (endpoint.includes('/api/numbers/sms/')) {
                return {
                    message: "获取验证码成功",
                    code: Math.floor(100000 + Math.random() * 900000).toString(),
                    phone_number: {
                        id: generateId(),
                        number: generatePhone(),
                        status: "used",
                        project_id: 1,
                        project_name: "微信登录",
                        user_id: 1,
                        sms_code: Math.floor(100000 + Math.random() * 900000).toString(),
                        request_id: endpoint.split('/').pop(),
                        created_at: now,
                        updated_at: now,
                        released_at: null
                    }
                };
            }
            
            if (endpoint.includes('/api/numbers/release/')) {
                return {
                    message: "号码释放成功"
                };
            }
            
            if (endpoint === '/api/numbers/blacklist') {
                return {
                    message: "号码已加入黑名单"
                };
            }
            
            if (endpoint === '/api/numbers/my-numbers') {
                return {
                    items: [
                        {
                            id: generateId(),
                            number: generatePhone(),
                            status: params.status || "available",
                            project_id: 1,
                            project_name: "微信登录",
                            user_id: 1,
                            sms_code: null,
                            request_id: "req_" + Date.now(),
                            created_at: now,
                            updated_at: now,
                            released_at: null
                        }
                    ],
                    total: 1,
                    page: parseInt(params.page) || 1,
                    per_page: parseInt(params.per_page) || 10,
                    pages: 1
                };
            }
            
            // 账户相关接口
            if (endpoint === '/api/account/balance') {
                return {
                    balance: userData.balance || 100.0
                };
            }
            
            if (endpoint === '/api/account/transactions') {
                return {
                    items: [
                        {
                            id: generateId(),
                            user_id: 1,
                            amount: -1.0,
                            balance: 99.0,
                            type: params.type || "consume",
                            description: "获取项目微信登录的手机号码",
                            reference_id: "req_12345",
                            created_at: now
                        }
                    ],
                    total: 1,
                    page: parseInt(params.page) || 1,
                    per_page: parseInt(params.per_page) || 10,
                    pages: 1
                };
            }
            
            if (endpoint === '/api/account/topup') {
                const amount = parseFloat(params.amount) || 0;
                return {
                    message: "充值成功",
                    balance: (userData.balance || 100.0) + amount
                };
            }
            
            // 默认返回
            return {
                error: "未知接口",
                message: "该接口在离线模式下不可用"
            };
        }
    </script>
</body>
</html> 